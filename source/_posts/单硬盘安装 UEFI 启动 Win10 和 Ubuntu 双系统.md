---
title: 单硬盘安装 UEFI 启动 Win10 和 Ubuntu 双系统
date: 2019-01-15 21:41:54
categories: "Ubuntu" #文章分類目錄 可以省略
tags: #文章標籤 可以省略
     - Ubuntu
---
前几天体验了下黑苹果，把之前的双系统都格了。体验下来，各种闪屏 + 驱动不适配的问题，后面还是决定换回之前的 Windows + Ubuntu 双系统。

在了解的过程中，发现现在新一代的电脑都支持通过 UEFI + GPT 引导，查了下资料都说这种方式是新出的引导方式，有很多优点，启动快，支持无限分区等。正好我的老本也支持 UEFI，所以从 BIOS + MBR 换成 UEFI + GPT。

我这里的方案是 120G 的 SSD 中装双系统。

## UEFI 方式安装 Windows

首先制作 PE 启动盘，进入 BIOS 把 **启动方式从 Legacy 改为 UEFI 启动**。

进入 PE 打开分区软件 DiskGenius，把硬盘格式转为 GPT。

![转换硬盘格式](转换硬盘格式.jpg)

删除硬盘中所有分区，点击 “建立新分区” 重新创建一个新的分区。这里要勾上建立 ESP分区，我这里给出的大小是 400 MB。MSR 分区可建可不建。我没有建。

![硬盘分区](硬盘分区.jpg)

分区完成以后，按常规的安装 Windows 的方法即可。

## Windows 分配硬盘空间

安装 Windows 成功后，进入磁盘管理，分配出一块用以安装 Ubuntu 的 **空闲空间**。注意，是空闲空间，不要去格式化，保证其“未分配”属性（Linux的文件系统和Win是不一样的，NTFS和FAT32都不适用）

## 制作 Ubuntu 启动盘

网上有些资料说 Ubuntu 镜像本身就带了 UEFI 启动，只需要把镜像文件解压到 U 盘中就可以启动安装，我尝试了没有成功。

后来用了 Ubuntu 官方推荐的U盘安装方法 [rufus](https://rufus.ie/en_IE.html)。

![rufus](rufus.png)

rufus 有 ISO 和 DD 两种烧录方式，如果默认的 ISO 模式进不去安装界面，可以试试 DD 模式（我就是 ISO 没成功，查了半天，结果换成 DD 模式就成功了）。

## 安装 Ubuntu

> 这部分转载自 [亲测UEFI启动模式的电脑安装Win10和Ubuntu双系统](https://blog.csdn.net/ysy950803/article/details/52643737)，仅做了些许修改。

重新启动，BIOS 选中 USB 启动，进入 Ubuntu 安装流程。

安装过程中，**为了尽快安装成功，不要勾选联网**，可以安装完成后再做更新软件等操作。另外，**不要选择“与其它系统共存”那一项，而选择最后那个“其它选项（创建自己的分区）”**。

**最最最关键的就是分区这一步，这一步直接影响你安装双系统是否成功！找到刚才分割出的未分配空间，点”+“按钮来挂载分区。选择的时候一定要看清楚，一般来说根据大小就能判断，不要手滑把 Win 所在的空间给格式化掉了。并且，可能会看到一些几十 MB 或者一百来 MB的已用空间，不要去动它们，可能是分区恢复盘之类的：**

1. **swap交换空间**，这个也就是虚拟内存的地方，选择**主分区**和**空间起始位置**。如果你给 Ubuntu 系统分区容量足够的话，最好是能给到你物理内存的 2 倍大小，像我 8GB 内存，就可以给个 16GB 的空间给它，这个看个人使用情况，太小也不好，太大也没用。（其实我只给了 8GB，没什么问题）

2. 新建 **efi 系统分区**， 选中**逻辑分区** （这里不是主分区，请勿怀疑，老式的 boot 挂载才是主分区）和空间起始位置，大小最好不要小于256MB，系统引导文件都会在里面，如果这分区满了可能会带来未知问题。我给的**512MB**，它的作用和boot引导分区一样，只是引导方式不同。不要按照那些老教程去选boot引导分区，**也就是最后你的挂载点里没有“/boot”这一项**，否则你就没办法UEFI启动两个系统了。

3. **挂载“/home”**， 类型为**EXT4日志文件系统**，选中**逻辑分区**和**空间起始位置**，这个相当于你的个人文件夹，类似Windows里的User，如果你是个娱乐向的用户，我建议最好能分配稍微大点，因为你的图片、视频、下载内容基本都在这里面，这些东西可不像在Win上面你想移动就能移动的。总的来说，最好不要低于 **8GB**，我 Ubuntu 分区的总大小是64GB，这里我给了 12GB 给 home。

4. **挂载“/usr”** （也可以不挂，就直接包括在“/”当中），类型为**EXT4日志文件系统**，选中**逻辑分区**和**空间起始位置**，这个相当于你的软件安装位置，Linux 下一般来说安装第三方软件你是没办法更改安装目录的，系统都会统一地安装到 /usr 目录下面，因此你就知道了，这个分区必须要大，我给了 32GB。

5. 最后，**挂载“/”**，类型为**EXT4日志文件系统**，选中**逻辑分区**和**空间起始位置**，
因为除了 home 和 usr 还有很多别的目录，但那些都不是最重要的，“/”就把除了之前你挂载的home和usr外的全部杂项囊括了，大小也不要太小，最好不低于 8GB。如果你非要挨个仔细分配空间，那么你需要知道这些各个分区的含义（[Linux(ubuntu)分区挂载点介绍](http://blog.sina.com.cn/s/blog_5f0a505101017ruf.html)）
不过就算你把所有目录都自定义分配了空间也必须要给“/”挂载点分配一定的空间。

分配好各个挂载点后，还有一个至关重要的步骤，那就是选择 **“安装引导启动器的设备”**，默认是错误的，既然我们为Ubuntu分配了efi系统引导分区，那么显然，这里应该把它**改成刚刚第2步分配efi引导的那个分区**（比如我安装时它是/dev/sda7，那么我就选这个）。
